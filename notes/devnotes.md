# Design and coding notes

## Validate Params

Validate param for null or illegal argument (not required for private methods). validate IllegalState for state vars, injected state vars (not required for private methods).

Apart from model classes, as far as possible, try to use primitives as validation of method param is not required for primitives.

## Coding 

- to join use Util.spaceit(), for delimited join use String.join()
- in steps
  - if exception is recoverable then catch and handle it otherwise if unrecoverable throw StepRunException (unchecked exception)
  - while throwing StepRunException don't log or add activity as tasks' exception handling takes care of it.
  - for StepRunException, don't use getLabeled() as task will handle label, for others use getLabeled() to create message which prefixes label. If message is used only with logger, then use {} and getLabel()

### JavaDoc guidelines

  - add /** and press enter to generate JavaDoc comments
  - remove any non-JavaDoc comments generated by eclipse
  - for methods that doesn't do anything add do nothing
  - for overridden method, add JavaDoc comments
  - use @see to link any project classes and also for java or external classes and methods
    - @see in text creates inline link
    - if used after tags (param,return) then added in See also section
  - use @throws both for checked and unchecked exception.
  - In method signature, add only the checked exceptions. Mention unchecked exceptions in JavaDoc with @throws

## Tricky errors

### JDO

  JDODataStoreException - Exception thrown flushing changes to datastore

  Set detachable as true in package.jdo for the class.

  In case detached object is persisted again and detachable is not true for the class then instead of update jdo inserts new object. If this results in constraint violation then jdo throws NullPointerExcetpion.
  
### Jackson

find field in node or child nodes

	findValue(String fieldName) - JsonNode or null 
	findPath(String fieldName) - JsonNode or MissingNode

find direct field 

	get(String fieldName) - JsonNode or null
	path(String fieldName) - JsonNode or MissingNode

set nodes

	set(fieldName, node) - add field and set node 
	setAll(node) - add node directly 

### XML namespace

  getNamespaceURI() on document returns null but for jaxb elementNSImpl it returns uri.
  better option is to use lookupNamespaceURI() with null for default ns.

