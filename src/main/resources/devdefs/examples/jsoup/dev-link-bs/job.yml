locatorGroups:
  quote:   
    locators: [
       { name: acme, url: "/defs/examples/page/acme-quote-links.html" }  
    ]

dataDefs:

  links:
    axis:
      fact:
        query:
          region: "#page_links > table > tbody > tr > td:nth-child(4) > ul"  
          field: "li:nth-child(%{row.index}) > a[href]"
          attribute: "href"
        prefix: [ "/defs/examples/page/" ]   
      col:
        query:
          script: "configs.getRunDateTime()"                  
        members: [ 
          member: {name: date},
        ]  
      row:
        query:
          region: "#page_links > table > tbody > tr > td:nth-child(4) > ul"
          field: "li:nth-child(%{row.index}) > a[href]"      
        members: [ 
          member: {name: bs, index: 2, linkGroup: bs},                   
        ]
                              
  bs:
    axis:
      fact:
        query:
          region: "table:contains(Sources Of Funds)"  
          field: "tr:nth-child(%{row.index}) > td:nth-child(%{col.index})" 
      col:
        query:
          region: "table:contains(Sources Of Funds)"
          field: "tr:nth-child(1) > td:nth-child(%{col.index})"        
        members: [ 
          member: {name: year, indexRange: 2-3},
        ]  
      row:
        query:
          region: "table:contains(Sources Of Funds)"
          field: "tr:nth-child(%{row.index}) > td:nth-child(1)"      
        members: [ 
          member: {name: item, index: 5, breakAfter: ["Reserves"] },
        ]
        filters: [ 
          filter: { type: value, pattern: "" },
          filter: { type: value, pattern: "Sources Of Funds" },                   
        ]
                                        
taskGroups:

  quote:
    linkTask:
      dataDef: links
      steps:
        dev-default:
          process:
            class: "org.codetab.scoopi.step.convert.LocatorCreator"
            previous: parser
            next: seeder
            
  bs:
    bsTask:
      dataDef: bs
      steps:
        dev-default:
          converter:
            class: "org.codetab.scoopi.step.convert.DataConverter"
            previous: process
            next: appender           
            plugins: [
              plugin: { 
                     name: converter, 
                     class: "org.codetab.scoopi.plugin.converter.DateRoller", 
                     axis: col, 
                     inPattern: "MMM ''YY", 
                     outPattern: "yyyy-MM-dd", 
                     roll: "DAY_OF_MONTH=ceil" }            
           ]

steps: 
  dev-default:
    seeder:
      class: "org.codetab.scoopi.step.extract.LocatorSeeder"
      previous: start
      next: loader
    loader:
      class: "org.codetab.scoopi.step.extract.URLLoader"
      previous: seeder
      next: parser
    parser:
      class: "org.codetab.scoopi.step.parse.jsoup.JSoupParser"
      previous: loader
      next: process
    process:
      class: "org.codetab.scoopi.step.convert.DataFilter"
      previous: parser
      next: converter
    converter:
      class: "org.codetab.scoopi.step.convert.DataConverter"
      previous: process
      next: appender
    appender:
      class: "org.codetab.scoopi.step.load.DataAppender"
      previous: converter
      next: end
      plugins: [
        plugin: { 
          name: file, 
          class: "org.codetab.scoopi.plugin.appender.FileAppender",
          file: "output/data.txt", 
          plugins: [ 
             plugin: { 
               name: csv,
               class: "org.codetab.scoopi.plugin.encoder.CsvEncoder"
             } 
          ]
        },
        plugin: { 
          name: dumpfile, 
          class: "org.codetab.scoopi.plugin.appender.FileAppender",
          file: "output/dump.txt", 
          plugins: [ 
             plugin: { 
               name: dump,
               class: "org.codetab.scoopi.plugin.encoder.CsvEncoder",
               delimiter: "|"
             } 
          ]
        }          
      ]

